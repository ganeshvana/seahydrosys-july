<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <template id="report_purchase_custom" inherit_id="purchase.report_purchaseorder_document">
            <xpath expr="//div[@class='page']" position="replace">
                <div class="page">
            <div class="oe_structure"/>

            <h2 t-if="o.state in ['draft', 'sent', 'to approve']">Request for Quotation #<span t-field="o.name"/></h2>
            <h2 t-if="o.state in ['purchase', 'done']">Purchase Order #<span t-field="o.name"/></h2>
            <h2 t-if="o.state == 'cancel'">Cancelled Purchase Order #<span t-field="o.name"/></h2>

            <div id="informations" class="row mt32 mb32">
                <div t-if="o.user_id" class="col-3 bm-2">
                    <strong>Purchase Representative:</strong>
                    <p t-field="o.user_id" class="m-0"/>
                </div>
                <div t-if="o.partner_ref" class="col-3 bm-2">
                    <strong>Your Order Reference:</strong>
                    <p t-field="o.partner_ref" class="m-0"/>
                </div>
                <div t-if="o.date_order" class="col-3 bm-2">
                    <strong>Order Date:</strong>
                    <p t-field="o.date_order" class="m-0"/>
                </div>
                <div t-if="o.payment_term_id" class="col-auto">
                    <strong>Payment Terms:</strong>
                    <p style="width:150px;" t-field="o.payment_term_id"/>
                </div>
                <div t-if="o.despatch_through" class="col-auto" >
                    <strong>Despatch Through:</strong>
                    <p style="width:150px;" t-field="o.despatch_through"/>
                </div>
                <div t-if="o.incoterm_id" class="col-auto" >
                    <strong>Incoterm:</strong>
                    <p style="width:150px;" t-field="o.incoterm_id.name"/>
                </div>
            </div>

            <table class="table table-sm o_main_table">
                <thead>
                    <tr> 
                        <th><strong>Sl.No.</strong></th>
                        <th><strong>Part Code</strong></th>
                        <th name="th_description"><strong>Description</strong></th>
                        <th name="th_taxes"><strong>Taxes</strong></th>
                        <th name="th_date_req" class="text-center"><strong>Date Req.</strong></th>
                        <th name="th_quantity" class="text-right"><strong>Qty</strong></th>
                        <th name="th_price_unit" class="text-right"><strong>Unit Price</strong></th>
                        <th name="th_amount" class="text-right"><strong>Amount</strong></th>
                    </tr>
                </thead>
                <tbody>
                    <t t-set="current_subtotal" t-value="0"/>
                    <t t-foreach="o.order_line" t-as="line">
                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_subtotal" groups="account.group_show_line_subtotals_tax_excluded"/>
                        <t t-set="current_subtotal" t-value="current_subtotal + line.price_total" groups="account.group_show_line_subtotals_tax_included"/>

                        <tr t-att-class="'bg-200 font-weight-bold o_line_section' if line.display_type == 'line_section' else 'font-italic o_line_note' if line.display_type == 'line_note' else ''">
                            <t t-if="not line.display_type">
                                <td>
                                    <span t-esc="line_index+1"/>
                                </td>
                                <td>
                                    <span t-field="line.product_id.default_code"/>
                                </td>
                                <td id="product">
                                    <span t-field="line.name"/>
                                </td>
                                <td name="td_taxes">
                                    <span t-esc="', '.join(map(lambda x: x.name, line.taxes_id))"/>
                                </td>
                                <td class="text-center">
                                    <span t-field="line.date_planned"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="line.product_qty"/>
                                    <span t-field="line.product_uom.name" groups="uom.group_uom"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="line.price_unit"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="line.price_subtotal"
                                        t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                </td>
                            </t>
                            <t t-if="line.display_type == 'line_section'">
                                <td colspan="99" id="section">
                                    <span t-field="line.name"/>
                                </td>
                                <t t-set="current_section" t-value="line"/>
                                <t t-set="current_subtotal" t-value="0"/>
                            </t>
                            <t t-if="line.display_type == 'line_note'">
                                <td colspan="99" id="note">
                                    <span t-field="line.name"/>
                                </td>
                            </t>
                        </tr>
                        <t t-if="current_section and (line_last or o.order_line[line_index+1].display_type == 'line_section')">
                            <tr class="is-subtotal text-right">
                                <td colspan="99" id="subtotal">
                                    <strong class="mr16">Subtotal</strong>
                                    <span
                                        t-esc="current_subtotal"
                                        t-options='{"widget": "monetary", "display_currency": o.currency_id}'
                                    />
                                </td>
                            </tr>
                        </t>
                    </t>
                </tbody>
            </table>

            <div id="total" class="row justify-content-end">
                <div class="col-4">
                    <table class="table table-sm">
                        <t t-set="tax_totals" t-value="json.loads(o.tax_totals_json)"/>
                        <t t-call="account.document_tax_totals"/>
                    </table>
                </div>
            </div>
            ############################ Customized ################################
            <!--  <div>
                <span t-if="o.mo_product"><b>MO Product</b></span>: <span t-field="o.mo_product"/>
            </div> -->

            <div>
                <span><b>Terms of Delivery (Vendors)</b></span><br/>
                <p> <span>1. Purchase order number must appear in all invoices, delivery challans and all other correspondences</span><br />
                 <span>2. Material Supplied should be as per the specifications or drawing given by us.</span><br />
                 <span>3. Material Should be supplied along with the following documents Inspection report, Test certificates, dimension report &amp; invoices With PO References.</span><br />
                 <span>4. Material will be rejected if does not meet our specifications and should be collected by you within a week.</span><br />
                 <span>5. Invoice will be sent back to you, if you do not mention the product's HSN Code and GST Number in each and every invoice.</span><br />
                 <span>6. This PO will be valid only for 45 days.</span><br /></p>
               
            </div>
            ###########################################################################
            <p t-field="o.notes"/>
            <div class="oe_structure"/>
            ###########################################################################

            <div class="text-right" style="line-height: 50px; font-weight: bold; font-size: 15px;">
                <br/>                       
                <img class="img" src="/oi_shs_purchase_report_extend/static/src/img/sign.png" style="padding-right:15px;" />
                <br/>
                Authorised Signatory
            </div>
            ###########################################################################

        </div>
        </xpath>

            <xpath expr="//div[@class='page']" position="replace">
                <div class="page">
                    <div class="oe_structure"/>

                    <h2 t-if="o.state == 'draft'">Request for Quotation #<span t-field="o.name"/></h2>
                    <h2 t-if="o.state in ['sent', 'to approve']">Purchase Order #<span t-field="o.name"/></h2>
                    <h2 t-if="o.state in ['purchase', 'done']">Purchase Order No #<span t-field="o.name"/></h2>
                    <h2 t-if="o.state == 'cancel'">Cancelled Purchase Order #<span t-field="o.name"/></h2>

                    

                    <div id="informations" class="row mt32 mb32">
                        <div t-if="o.date_order" class="col-auto">
                            <strong>Order Date:</strong>
                            <p style="width:150px;" t-field="o.date_order" t-options='{"format": "dd/MM/yyyy"}'/>
                        </div>
                         <div t-if="o.due_date" class="col-auto">
                            <strong>Order Due Date:</strong>
                            <p style="width:150px;" t-field="o.due_date" t-options='{"format": "dd/MM/yyyy"}'/>
                        </div>
                        <div t-if="o.payment_term_id" class="col-auto">
                            <strong>Payment Terms:</strong>
                            <p style="width:150px;" t-field="o.payment_term_id"/>
                        </div>
                        
                        <div t-if="o.despatch_through" class="col-auto" >
                            <strong>Despatch Through:</strong>
                            <p style="width:150px;" t-field="o.despatch_through"/>
                        </div>
                        <div t-if="o.incoterm_id" class="col-auto" >
                            <strong>Incoterm:</strong>
                            <p style="width:150px;" t-field="o.incoterm_id.name"/>
                        </div>
                    </div>

                    <table class="table table-sm o_main_table">
                        <thead>
                            <tr>
                                <th><strong>Sl.No.</strong></th>
                                <th><strong>Part Code</strong></th>
                                <th><strong>Description</strong></th>
                                <th><strong>Taxes</strong></th>
                                <th class="text-center"><strong>Receipt Date</strong></th>
                                <th class="text-right"><strong>Qty</strong></th>
                                <th class="text-right"><strong>Unit Price</strong></th>
                                <th class="text-right"><strong>Amount</strong></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="o.order_line" t-as="line">
                                <td>
                                    <span t-esc="line_index+1"/>
                                </td>
                                <td>
                                    <span t-field="line.product_id.default_code"/>
                                </td>
                                <td>
                                    <span t-field="line.name"/>
                                </td>
                                <td>
                                    <span t-esc="', '.join(map(lambda x: x.name, line.taxes_id))"/>
                                </td>
                                <td class="text-center">
                                    <span t-field="line.date_planned" t-options='{"format": "dd/MM/yyyy"}'/>
                                </td>
                                <td class="text-right">
                                    <span t-field="line.product_qty"/>
                                    <span t-field="line.product_uom.name" groups="uom.group_uom"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="line.price_unit"/>
                                </td>
                                <td class="text-right">
                                    <span t-field="line.price_subtotal"
                                        t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <div id="total" class="row justify-content-end">
                        <div class="col-4">
                            <table class="table table-sm">
                                <tr class="border-black">
                                    <td><strong>Subtotal</strong></td>
                                    <td class="text-right">
                                        <span t-field="o.amount_untaxed"
                                            t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                                <tr>
                                    <td>Taxes</td>
                                    <td class="text-right">
                                        <span t-field="o.amount_tax"
                                            t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                                <tr class="border-black o_total">
                                    <td><strong>Total</strong></td>
                                    <td class="text-right">
                                        <span t-field="o.amount_total"
                                            t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                    </td>
                                </tr>
                            </table>
                        </div>
                    </div>
                    
                   <!--  <div>
                        <span t-if="o.mo_product"><b>MO Product</b></span>: <span t-field="o.mo_product"/>
                    </div> -->

                    <div>
                        <span><b>Terms of Delivery (Vendors)</b></span><br/>
                        <p> <span>1. Purchase order number must appear in all invoices, delivery challans and all other correspondences</span><br />
                         <span>2. Material Supplied should be as per the specifications or drawing given by us.</span><br />
                         <span>3. Material Should be supplied along with the following documents Inspection report, Test certificates, dimension report &amp; invoices With PO References.</span><br />
                         <span>4. Material will be rejected if does not meet our specifications and should be collected by you within a week.</span><br />
                         <span>5. Invoice will be sent back to you, if you do not mention the product's HSN Code and GST Number in each and every invoice.</span><br />
                         <span>6. This PO will be valid only for 45 days.</span><br /></p>
                       
                    </div>

                    <p t-field="o.notes"/>
                    <div class="oe_structure"/>
                
                    <div class="text-right" style="line-height: 50px; font-weight: bold; font-size: 15px;">
                        <br/>                       
                        <img class="img" src="/itara_purchase_report_extend/static/src/img/sign.png" style="padding-right:15px;" />
                        <br/>
                        Authorised Signatory
                    </div>
                </div>
               

            </xpath>
            
        
          
        </template>
    </data>
</odoo>